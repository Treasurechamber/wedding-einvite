<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sarah & Michael | E-Invitation</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <!-- Supabase JS -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <style>
    :root {
      --primary: #d4b08c;
      --bg: #f8f5f2;
      --text: #2c3e50;
    }
    * { box-sizing: border-box; margin:0; padding:0 }
    body { font-family:sans-serif; background:var(--bg); color:var(--text); }
    nav { background:var(--primary); padding:1rem; display:flex; gap:1rem; }
    nav a { color:#fff; text-decoration:none; }
    section { padding:2rem; text-align:center }
    #countdown span { display:inline-block; min-width:2.5rem; font-size:2rem }
    .timeline { display:flex; justify-content:center; gap:1rem; margin-top:1rem }
    .timeline div { background:#fff; padding:1rem; border-radius:5px; cursor:pointer; box-shadow:0 2px 6px rgba(0,0,0,.1) }
    /* slideshow modal */
    #slideshow-modal {
      display:none;
      position:fixed; inset:0;
      background:rgba(0,0,0,.8);
      justify-content:center; align-items:center;
    }
    #slideshow-modal img { max-width:80%; max-height:80%; }
    #slideshow-modal button {
      position:absolute; background:transparent; border:none; color:#fff; font-size:2rem;
      top:1rem; cursor:pointer;
    }
    #modal-prev { left:1rem }
    #modal-next { right:1rem }
    #modal-close { right:1rem; top:1rem }
    /* RSVP form */
    form { display:inline-block; text-align:left; background:#fff; padding:1rem; border-radius:5px; box-shadow:0 2px 6px rgba(0,0,0,.1) }
    form input, form button { display:block; width:100%; margin:0.5rem 0; padding:0.5rem }
    #rsvp-msg { margin-top:1rem; color:green; }
  </style>
</head>
<body>

  <nav>
    <a href="#hero">Home</a>
    <a href="#countdown">Save the Date</a>
    <a href="#timeline">Our Story</a>
    <a href="#rsvp">RSVP</a>
    <a href="admin.html">Admin</a>
  </nav>

  <section id="hero">
    <h1>Sarah &amp; Michael</h1>
    <p>AUGUST 15, 2025</p>
  </section>

  <section id="countdown">
    <h2>Save the Date</h2>
    <div id="cd">
      <span id="d">00</span>d
      <span id="h">00</span>h
      <span id="m">00</span>m
      <span id="s">00</span>s
    </div>
  </section>

  <section id="timeline">
    <h2>Our Story</h2>
    <div class="timeline">
      <div data-event="meeting">First Meeting</div>
      <div data-event="date">First Date</div>
      <div data-event="move">Moving In</div>
      <div data-event="proposal">Proposal</div>
    </div>
  </section>

  <!-- Slideshow Modal -->
  <div id="slideshow-modal">
    <button id="modal-close">×</button>
    <button id="modal-prev">‹</button>
    <img id="slide-img" src="">
    <button id="modal-next">›</button>
  </div>

  <section id="rsvp">
    <h2>RSVP</h2>
    <form id="rsvp-form">
      <input type="text" id="name" placeholder="Your Name" required>
      <input type="email" id="email" placeholder="Your Email" required>
      <label>
        <input type="radio" name="attend" value="yes" checked> Yes, I'll be there
      </label>
      <label>
        <input type="radio" name="attend" value="no"> Sorry, I can't
      </label>
      <button type="submit">Submit</button>
    </form>
    <div id="rsvp-msg"></div>
  </section>

  <script>
    // ─── Supabase Setup ─────────────────────────
    const supabase = supabase.createClient(
      'https://YOUR_SUPABASE_URL.supabase.co',
      'YOUR_SUPABASE_ANON_KEY'
    );

    // ─── Countdown ──────────────────────────────
    const weddingDate = new Date('2025-08-15T14:00:00');
    function updateCountdown() {
      const diff = weddingDate - new Date();
      if (diff <= 0) return;
      const d = Math.floor(diff/86400000),
            h = Math.floor(diff%86400000/3600000),
            m = Math.floor(diff%3600000/60000),
            s = Math.floor(diff%60000/1000);
      document.getElementById('d').textContent = String(d).padStart(2,'0');
      document.getElementById('h').textContent = String(h).padStart(2,'0');
      document.getElementById('m').textContent = String(m).padStart(2,'0');
      document.getElementById('s').textContent = String(s).padStart(2,'0');
    }
    setInterval(updateCountdown,1000);
    updateCountdown();

    // ─── RSVP Submission ────────────────────────
    document.getElementById('rsvp-form').addEventListener('submit', async e => {
      e.preventDefault();
      const name = document.getElementById('name').value;
      const email = document.getElementById('email').value;
      const attend = document.querySelector('input[name="attend"]:checked').value === 'yes';
      const { error } = await supabase
        .from('rsvps')
        .insert([{ name, email, attend, created_at: new Date() }]);
      document.getElementById('rsvp-msg').textContent = error
        ? 'Submission failed, please try again.'
        : 'Thank you for your response!';
      if (!error) e.target.reset();
    });

    // ─── Timeline → Slideshow ───────────────────
    const eventPics = {
      meeting: ['img/meet1.jpg','img/meet2.jpg'],
      date:    ['img/date1.jpg','img/date2.jpg'],
      move:    ['img/move1.jpg','img/move2.jpg'],
      proposal:['img/proposal1.jpg','img/proposal2.jpg']
    };
    let slides, idx=0;
    const modal = document.getElementById('slideshow-modal'),
          imgEl = document.getElementById('slide-img');

    document.querySelectorAll('.timeline div').forEach(el => {
      el.onclick = () => {
        slides = eventPics[el.dataset.event] || [];
        if (!slides.length) return;
        idx = 0;
        imgEl.src = slides[idx];
        modal.style.display = 'flex';
      };
    });
    document.getElementById('modal-prev').onclick = () => {
      idx=(idx-1+slides.length)%slides.length;
      imgEl.src = slides[idx];
    };
    document.getElementById('modal-next').onclick = () => {
      idx=(idx+1)%slides.length;
      imgEl.src = slides[idx];
    };
    document.getElementById('modal-close').onclick = () => modal.style.display='none';
    modal.addEventListener('click', e => {
      if (e.target===modal) modal.style.display='none';
    });
  </script>
</body>
</html>
