<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Wedding Invitation - Sarah & Michael</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css">
  <style>
    /* Use your original CSS styles here */
    body { font-family: 'Montserrat', sans-serif; background: #f8f5f2; color: #333; margin: 0; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; }
    .modal-content { background: white; margin: 10% auto; padding: 20px; border-radius: 8px; max-width: 600px; position: relative; }
    .close-modal { position: absolute; top: 10px; right: 15px; font-size: 24px; cursor: pointer; }
    .gallery-item img { width: 100%; height: auto; border-radius: 8px; }
    .timeline-item { cursor: pointer; }
  </style>
</head>
<body>
  <section class="timeline">
    <div class="timeline-item"><div class="timeline-content"><h3>The First Meeting</h3></div></div>
    <div class="timeline-item"><div class="timeline-content"><h3>First Date</h3></div></div>
    <div class="timeline-item"><div class="timeline-content"><h3>Moving In Together</h3></div></div>
    <div class="timeline-item"><div class="timeline-content"><h3>The Proposal</h3></div></div>
  </section>

  <div id="story-modal" class="modal">
    <div class="modal-content">
      <span class="close-modal" id="close-story-modal">&times;</span>
      <h3 id="story-title"></h3>
      <div id="story-slideshow" class="gallery-slider"></div>
      <p id="story-description"></p>
    </div>
  </div>

  <div class="admin-dashboard">
    <div class="stats-grid"></div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
  <script>
    const supabase = supabase.createClient('YOUR_SUPABASE_URL', 'YOUR_SUPABASE_KEY');

    const timelineEvents = [
      { title: 'The First Meeting', description: 'We met at a mutual friend\'s party.', images: ['/api/placeholder/600/400'] },
      { title: 'First Date', description: 'Art gallery and rooftop dinner.', images: ['/api/placeholder/600/400'] },
      { title: 'Moving In Together', description: 'We got our first apartment.', images: ['/api/placeholder/600/400'] },
      { title: 'The Proposal', description: 'A snowy proposal under lights.', images: ['/api/placeholder/600/400'] }
    ];

    const storyModal = document.getElementById('story-modal');
    const storyTitle = document.getElementById('story-title');
    const storyDescription = document.getElementById('story-description');
    const storySlideshow = document.getElementById('story-slideshow');

    document.querySelectorAll('.timeline-item').forEach((item, index) => {
      item.addEventListener('click', () => {
        const event = timelineEvents[index];
        storyTitle.textContent = event.title;
        storyDescription.textContent = event.description;
        storySlideshow.innerHTML = event.images.map(src => `<div class='gallery-item'><img src='${src}' alt='Story image'></div>`).join('');
        $(storySlideshow).slick({ dots: true, arrows: true, infinite: true, speed: 500, slidesToShow: 1 });
        storyModal.style.display = 'block';
      });
    });

    document.getElementById('close-story-modal').addEventListener('click', () => {
      storyModal.style.display = 'none';
      $(storySlideshow).slick('unslick');
    });

    async function loadAdminDataWithChart() {
      const { data, error } = await supabase.from('rsvps').select('*');
      if (error) return console.error(error);
      const attending = data.filter(d => d.attending).length;
      const notAttending = data.length - attending;
      const canvas = document.createElement('canvas');
      canvas.id = 'rsvpChart';
      document.querySelector('.stats-grid').appendChild(canvas);
      new Chart(canvas, {
        type: 'doughnut',
        data: {
          labels: ['Attending', 'Not Attending'],
          datasets: [{
            data: [attending, notAttending],
            backgroundColor: ['#4CAF50', '#F44336'],
            hoverOffset: 10
          }]
        },
        options: { responsive: true, plugins: { legend: { position: 'bottom' } } }
      });
    }
    loadAdminDataWithChart();
  </script>
</body>
</html>
